// Log by Josh Avanier
var Log={log:[],status:function(){return"undefined"==Log.log[Log.log.length-1].e?"grn":"red"},display:function(){var b=document.getElementById("logbook"),c=Log.time,d=Aequirys;b.className="bn f6 mon";for(var a=function(a,b){var c=null==a?0:a.length;if(!c)return[];b=c-(void 0===b?1:b);var d=0>b?0:b;var e=c;if(c=null==a?0:a.length){d=null==d?0:d;e=void 0===e?c:e;0>d&&(d=-d>c?0:c+d);e=e>c?c:e;0>e&&(e+=c);c=d>e?0:e-d>>>0;d>>>=0;e=-1;for(var f=Array(c);++e<c;)f[e]=a[e+d];d=f}else d=[];return d}(Log.log,
30),e=0,f=a.length;e<f;e++){var g=a[e],k=b.insertRow(e+2),h=k.insertCell(0),l=k.insertCell(1),n=k.insertCell(2),p=k.insertCell(3),m=k.insertCell(4),v=k.insertCell(5);k=k.insertCell(6);var t=c.parse(g.s),q=c.parse(g.e),u=c.convert(t),r=function(a,b){a.innerHTML=b};r(h,d.dis(d.con(new Date(u.getFullYear(),u.getMonth(),u.getDate()))));r(l,c.stamp(t));r(n,c.stamp(q));r(p,c.duration(t,q).toFixed(2));m.innerHTML=g.c;v.innerHTML=g.t;k.innerHTML=g.d}},visualise:function(){for(var b=document.getElementById("vis"),
c=0,d=0,a={},e=0,f=Log.log.length;e<f;a={e:a.e,date:a.date,time:a.time},e++){a.e=Log.log[e];a.time=Log.time;var g=function(a){return function(b){var e=document.createElement("div");e.className="psr t0 sh2 mb2 lf "+("PHO"==a.e.c?"bg-blu":"RES"==a.e.c?"bg-grn":"DSG"==a.e.c?"bg-red":"ACA"==a.e.c?"bg-ylw":"bg-blanc");e.style.width=b.p+"%";e.style.margin="0 0 0 "+b.m+"%";document.getElementById("v"+a.date).appendChild(e);c=b.p;d=b.dp}}(a),k=function(a){return function(b,e){var f=(b-e)/86400*100,g=a.time.convert(e),
h=g.getFullYear(),k=g.getMonth(),l=g.getDate(),q=(new Date(h,k,l)).getTime()/1E3,m=(new Date(h,k,l,23,59,59)).getTime()/1E3;g=((new Date(h,k,l,g.getHours(),g.getMinutes(),g.getSeconds())).getTime()/1E3-q)/(m-q)*100;return{dp:g,p:f,m:g-(c+d)}}}(a),h=function(a,e){d=c=0;var g=document.createElement("p"),f=document.createElement("div");f.className="db wf sh2 mt2 mb3 bsia bg-111 br1";f.id="v"+e;b.appendChild(g);b.appendChild(f)};if("undefined"!=a.e.e){var l=a.time.parse(a.e.s),n=a.time.parse(a.e.e);a.date=
a.time.date(l);var p=a.time.date(n);if(a.date!==p){null===document.getElementById("v"+a.date)&&h(l,a.date);var m=a.time.convert(l);m=(new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59)).getTime()/1E3;g(k(a.time.parse((+m).toString(16)),l));null===document.getElementById("v"+p)&&h(l,p);h=a.time.convert(n);h=(new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0)).getTime()/1E3;g(k(n,a.time.parse((+h).toString(16))))}else null===document.getElementById("v"+a.date)&&h(l,a.date),g(k(n,l))}}},barChart:function(){for(var b=
document.getElementById("weekChart"),c=0,d=Log.time,a={},e=0,f=Log.log.length;e<f;a={e:a.e,date:a.date},e++){a.e=Log.log[e];var g=function(a){return function(b){var d=document.createElement("div");d.className="psa wf fw "+("PHO"==a.e.c?"bg-blu":"RES"==a.e.c?"bg-grn":"DSG"==a.e.c?"bg-red":"ACA"==a.e.c?"bg-ylw":"bg-noir");d.style.height=b+"%";d.style.bottom=c+"%";document.getElementById(a.date).appendChild(d);c+=b}}(a),k=function(a,b){return(a-b)/86400*100},h=function(a,d){c=0;var e=document.createElement("div");
e.className="dib hf psr";e.style.width="1%";e.id=d;b.appendChild(e)};if("undefined"!=a.e.e){var l=d.parse(a.e.s),n=d.parse(a.e.e);a.date=d.date(l);var p=d.date(n);if(a.date!==p){null===document.getElementById(a.date)&&h(l,a.date);var m=d.convert(l);m=(new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59)).getTime()/1E3;g(k(d.parse((+m).toString(16)),l));null===document.getElementById(p)&&h(l,p);h=d.convert(n);h=(new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0)).getTime()/1E3;g(k(n,d.parse((+h).toString(16))))}else null===
document.getElementById(a.date)&&h(l,a.date),g(k(n,l))}}},time:{parse:function(b){return parseInt(b,16)},convert:function(b){return new Date(1E3*b)},stamp:function(b){var c=Log.time.convert(b);b="0"+c.getHours();var d="0"+c.getMinutes();c="0"+c.getSeconds();return b.substr(-2)+":"+d.substr(-2)+":"+c.substr(-2)},date:function(b){b=Log.time.convert(b);return b.getFullYear()+""+b.getMonth()+""+b.getDate()},duration:function(b,c){return(c-b)/3600}},data:{getEntries:function(b){var c=[],d=Log.time;if(void 0==
b){b=0;for(var a=Log.log.length;b<a;b++)d=Log.log[b],"undefined"!=d.e&&c.push(d)}else{var e=0;for(a=Log.log.length;e<a;e++){var f=Log.log[e];if("undefined"!=f.e){var g=d.convert(d.parse(f.s));g.getFullYear()==b.getFullYear()&&g.getMonth()==b.getMonth()&&g.getDate()==b.getDate()&&c.push(f)}}}return c},lsmin:function(b){var c,d=Log.time,a=function(a){a=Number(d.duration(d.parse(a.s),d.parse(a.e)));if(a<c||void 0==c)c=a};if(void 0!=b)var e=Log.data.getEntries(b),f=0;else e=Log.data.getEntries(),f=0;
for(b=e.length;f<b;f++)a(e[f]);return c},lsmax:function(b){var c,d=Log.time,a=function(a){a=Number(d.duration(d.parse(a.s),d.parse(a.e)));if(a>c||void 0==c)c=a};if(void 0!=b)var e=Log.data.getEntries(b),f=0;else e=Log.data.getEntries(),f=0;for(b=e.length;f<b;f++)a(e[f]);return c},asd:function(){for(var b=0,c=0,d=Log.time,a=0,e=Log.log.length;a<e;a++){var f=Log.log[a];"undefined"!=f.e&&(b+=Number(d.duration(d.parse(f.s),d.parse(f.e))),c++)}return b/c},lh:function(b){var c=0,d=Log.time,a=function(a){return Number(d.duration(d.parse(a.s),
d.parse(a.e)))};if(void 0!=b)var e=Log.data.getEntries(b),f=0;else e=Log.data.getEntries(),f=0;for(b=e.length;f<b;f++)c+=a(e[f]);return c},lp:function(b){var c=0;var d=Log.time;void 0!=b?d=0==Log.data.getEntries(b).length?0:Log.data.lh(new Date):(c=d.convert(d.parse(Log.log[0].s)),b=new Date,d=Number(Log.data.lh()),c=Math.ceil((new Date(b.getFullYear(),b.getMonth(),b.getDate())-new Date(c.getFullYear(),c.getMonth(),c.getDate()))/864E5));return d/(24*(c+1))*100},sh:function(b){for(var c=0,d=Log.time,
a=0,e=Log.log.length;a<e;a++){var f=Log.log[a];"undefined"!=f.e&&f.c==b&&(c+=Number(d.duration(d.parse(f.s),d.parse(f.e))))}return c},sp:function(b){return Log.data.sh(b)/Log.data.lh()*100}},openSect:function(b){for(var c=document.getElementsByClassName("sect"),d=document.getElementsByClassName("tab"),a=0,e=c.length;a<e;a++)c[a].style.display="none";c=0;for(e=d.length;c<e;c++)d[c].className="pv1 tab on bg-noir blanc f6 mon tk mr3";document.getElementById(b).style.display="block";document.getElementById("b-"+
b).className="pv1 tab on bg-noir blanc f6 mon tk mr3 bb"},init:function(){var b=Log.data,c=b.sp,d=new Date,a=function(a,b){document.getElementById(a).innerHTML=b.toFixed(2)};Log.log=log;Log.barChart();document.getElementById("status").className="rf mb4 f6 "+Log.status();a("LHH",b.lh());a("LHT",b.lh(d));a("LPH",b.lp());a("LPT",b.lp(d));a("ASD",b.asd());a("LSN",b.lsmin(d));a("LSX",b.lsmax(d));a("LSNH",b.lsmin());a("LSXH",b.lsmax());a("pCOD",c("COD"));a("pDSG",c("DSG"));a("pRES",c("RES"));a("pPHO",c("PHO"));
a("pACA",c("ACA"));Log.display();Log.visualise()}};
