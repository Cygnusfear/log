// Log by Josh Avanier
var Log={log:[],status:function(){return"undefined"==Log.log[Log.log.length-1].e?"grn":"red"},display:function(a,b){a=void 0===a?Log.log:a;for(var c=document.getElementById(b),e=Log.time,g=Aequirys,d=function(a,b){a.innerHTML=b},f=function(a,b){var e=null==a?0:a.length;if(!e)return[];b=e-(void 0===b?1:b);var c=0>b?0:b;var d=e;if(e=null==a?0:a.length){c=null==c?0:c;d=void 0===d?e:d;0>c&&(c=-c>e?0:e+c);d=d>e?e:d;0>d&&(d+=e);e=c>d?0:d-c>>>0;c>>>=0;d=-1;for(var g=Array(e);++d<e;)g[d]=a[d+c];c=g}else c=
[];return c}(a,30),h=0,k=f.length;h<k;h++){var n=f[h],l=c.insertRow(h+2),m=l.insertCell(0),q=l.insertCell(1),p=l.insertCell(2),r=l.insertCell(3),v=l.insertCell(4),t=l.insertCell(5);l=l.insertCell(6);var u=e.parse(n.s),x=e.parse(n.e),w=e.convert(u);d(m,g.dis(g.con(new Date(w.getFullYear(),w.getMonth(),w.getDate()))));d(q,e.stamp(u));d(p,e.stamp(x));d(r,e.duration(u,x).toFixed(2));v.innerHTML=n.c;t.innerHTML=n.t;l.innerHTML=n.d}},vis:{line:function(a,b){a=void 0===a?Log.log:a;for(var c=document.getElementById(b),
e=0,g=0,d=Log.time,f=function(a,c){var f=document.createElement("div");f.className="psr t0 sh1 mb2 lf "+("PHO"==a.c?"bg-bdbdbd":"RES"==a.c?"bg-a9a9a9":"DSG"==a.c?"bg-969696":"ACA"==a.c?"bg-828282":"bg-blanc");f.style.width=c.p+"%";f.style.margin="0 0 0 "+c.m+"%";document.getElementById(b+d.date(d.parse(a.s))).appendChild(f);e=c.p;g=c.dp},h=function(a,b){var c=(a-b)/86400*100,f=d.convert(b),h=f.getFullYear(),l=f.getMonth(),m=f.getDate(),k=(new Date(h,l,m)).getTime()/1E3;f=((new Date(h,l,m,f.getHours(),
f.getMinutes(),f.getSeconds())).getTime()/1E3-k)/((new Date(h,l,m,23,59,59)).getTime()/1E3-k)*100;return{dp:f,p:c,m:f-(e+g)}},k=function(a){g=e=0;var d=document.createElement("div");d.className="db wf sh1 mt2 mb3 bsia bg-noir br1";d.id=b+a;c.appendChild(d)},n=0,l=a.length;n<l;n++){var m=a[n];if("undefined"!=m.e){var q=d.parse(m.s),p=d.parse(m.e),r=d.date(q),v=d.date(p),t=b+r;r!==v?(null==document.getElementById(t)&&k(r),r=d.convert(q),f(m,h(d.parse((+((new Date(r.getFullYear(),r.getMonth(),r.getDate(),
23,59)).getTime()/1E3)).toString(16)),q)),null==document.getElementById(b+v)&&k(v),q=d.convert(p),f(m,h(p,d.parse((+((new Date(q.getFullYear(),q.getMonth(),q.getDate(),0,0)).getTime()/1E3)).toString(16))))):(null==document.getElementById(t)&&k(r),f(m,h(p,q)))}}},bar:function(a,b){for(var c=document.getElementById(b),e=0,g=Log.time,d=function(a,b){var c=document.createElement("div");c.className="psa wf fw br noir "+("PHO"==a.c?"bg-bdbdbd":"RES"==a.c?"bg-a9a9a9":"DSG"==a.c?"bg-969696":"ACA"==a.c?"bg-828282":
"bg-blanc");c.style.height=b+"%";c.style.bottom=e+"%";document.getElementById(g.date(g.parse(a.s))).appendChild(c);e+=b},f=function(a,b){return(a-b)/86400*100},h=function(a){e=0;var b=document.createElement("div");b.className="dib hf psr";b.style.width=100/30+"%";b.id=a;c.appendChild(b)},k=0,n=a.length;k<n;k++){var l=a[k];if("undefined"!=l.e){var m=g.parse(l.s),q=g.parse(l.e),p=g.date(m),r=g.date(q);p!==r?(null==document.getElementById(p)&&h(p),p=g.convert(m),d(l,f(g.parse((+((new Date(p.getFullYear(),
p.getMonth(),p.getDate(),23,59)).getTime()/1E3)).toString(16)),m)),null==document.getElementById(r)&&h(r),m=g.convert(q),d(l,f(q,g.parse((+((new Date(m.getFullYear(),m.getMonth(),m.getDate(),0,0)).getTime()/1E3)).toString(16))))):(null==document.getElementById(p)&&h(p),d(l,f(q,m)))}}},day:function(a){a=void 0===a?new Date:a;document.getElementById("daychart");a=Log.data.getEntries(a);for(var b=Log.time,c=0,e=0,g=function(a,b){var d=document.createElement("div");d.className="psr t0 hf mb2 lf "+("PHO"==
a.c?"bg-bdbdbd":"RES"==a.c?"bg-a9a9a9":"DSG"==a.c?"bg-969696":"ACA"==a.c?"bg-828282":"bg-blanc");d.style.width=b.p+"%";d.style.margin="0 0 0 "+b.m+"%";document.getElementById("dayChart").appendChild(d);c=b.p;e=b.dp},d=function(a,d){var g=(a-d)/86400*100,f=b.convert(d),h=f.getFullYear(),k=f.getMonth(),l=f.getDate(),n=(new Date(h,k,l)).getTime()/1E3;f=((new Date(h,k,l,f.getHours(),f.getMinutes(),f.getSeconds())).getTime()/1E3-n)/((new Date(h,k,l,23,59,59)).getTime()/1E3-n)*100;return{dp:f,p:g,m:f-(c+
e)}},f=0,h=a.length;f<h;f++){var k=a[f];"undefined"!=k.e&&g(k,d(b.parse(k.e),b.parse(k.s)))}},peakH:function(a){a=void 0===a?Log.log:a;var b=document.getElementById("peakTimesChart");a=Log.data.peakHours(a);for(var c=Log.utils.getMax(a),e=0,g=a.length;e<g;e++){var d=e,f=document.createElement("div"),h=document.createElement("div"),k="peak-"+d;var n=d==(new Date).getHours()?"bg-blanc":"bg-828282";f.className="dib hf psr line";f.style.width="4.166666666666667%";f.id=k;h.className="psa b0 wf fw "+n;
h.style.height=a[d]/c*100+"%";b.appendChild(f);document.getElementById(k).appendChild(h)}},peakD:function(a){a=void 0===a?Log.log:a;var b=document.getElementById("peakDaysChart");a=Log.data.peakDays(a);for(var c=Log.utils.getMax(a),e=0,g=a.length;e<g;e++){var d=e,f=document.createElement("div"),h=document.createElement("div"),k="peakday-"+d;var n=d==(new Date).getDay()?"bg-blanc":"bg-828282";f.className="dib hf psr line";f.style.width="14.285714285714286%";f.id=k;h.className="psa b0 wf fw "+n;h.style.height=
a[d]/c*100+"%";b.appendChild(f);document.getElementById(k).appendChild(h)}},sectorBar:function(a,b){a=void 0===a?Log.log:a;for(var c=Log.data.listSectors(a).sort(),e=0,g=c.length;e<g;e++){var d=c[e];Log.data.sh(a,d);var f=document.createElement("div");f.className="psr t0 hf mb2 lf "+("PHO"==d?"bg-bdbdbd":"RES"==d?"bg-a9a9a9":"DSG"==d?"bg-969696":"ACA"==d?"bg-828282":"bg-blanc");f.style.width=Log.data.sp(a,d)+"%";document.getElementById(b).appendChild(f)}},projectBars:function(a,b){a=void 0===a?Log.log:
a;for(var c=Log.data.listProjects(a).sort(),e=0,g=c.length;e<g;e++){var d=c[e],f=Log.data.ph(a,d),h=document.createElement("li"),k=document.createElement("span"),n=document.createElement("span"),l=document.createElement("div"),m=document.createElement("div");h.className="mb4 f6";k.className="f6 mb2 mon upc tk";n.className="f6 rf";l.className="wf sh2 mb3 bg-111";m.className="psr t0 hf lf bg-blanc";m.style.width=Log.data.pp(a,d)+"%";k.innerHTML=d;n.innerHTML="LH: "+f.toFixed(2);l.appendChild(m);h.appendChild(k);
h.appendChild(n);h.appendChild(l);document.getElementById(b).appendChild(h)}}},time:{parse:function(a){return parseInt(a,16)},convert:function(a){return new Date(1E3*a)},stamp:function(a){var b=Log.time.convert(a);a="0"+b.getHours();var c="0"+b.getMinutes();b="0"+b.getSeconds();return a.substr(-2)+":"+c.substr(-2)+":"+b.substr(-2)},date:function(a){a=Log.time.convert(a);return""+a.getFullYear()+a.getMonth()+a.getDate()},duration:function(a,b){return(b-a)/3600}},data:{getEntries:function(a){var b=
[];if(void 0==a){a=0;for(var c=Log.log.length;a<c;a++){var e=Log.log[a];"undefined"!=e.e&&b.push(e)}}else{e=Log.time;var g=0;for(c=Log.log.length;g<c;g++){var d=Log.log[g];if("undefined"!=d.e){var f=e.convert(e.parse(d.s));f.getFullYear()==a.getFullYear()&&f.getMonth()==a.getMonth()&&f.getDate()==a.getDate()&&b.push(d)}}}return b},listProjects:function(a){a=void 0===a?Log.log:a;for(var b=[],c=0,e=a.length;c<e;c++){var g=a[c],d=g.t;"undefined"!=g.e&&-1==b.indexOf(d)&&b.push(d)}return b},listSectors:function(a){a=
void 0===a?Log.log:a;for(var b=[],c=0,e=a.length;c<e;c++){var g=a[c],d=g.c;"undefined"!=g.e&&-1==b.indexOf(d)&&b.push(d)}return b},peakDays:function(a){a=void 0===a?Log.log:a;for(var b=[0,0,0,0,0,0,0],c=0,e=a.length;c<e;c++){var g=a[c];"undefined"!=g.e&&b[Log.time.convert(Log.time.parse(g.s)).getDay()]++}return b},peakHours:function(a){a=void 0===a?Log.log:a;for(var b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=Log.time,e=0,g=a.length;e<g;e++){var d=a[e];"undefined"!=d.e&&b[c.convert(c.parse(d.s)).getHours()]++}return b},
lsmin:function(a){a=void 0===a?Log.log:a;if(0==a.length)return 0;for(var b,c=Log.time,e=0,g=a.length;e<g;e++){var d=a[e];d=Number(c.duration(c.parse(d.s),c.parse(d.e)));if(d<b||void 0==b)b=d}return b},lsmax:function(a){a=void 0===a?Log.log:a;if(0==a.length)return 0;for(var b,c=Log.time,e=0,g=a.length;e<g;e++){var d=a[e];d=Number(c.duration(c.parse(d.s),c.parse(d.e)));if(d>b||void 0==b)b=d}return b},asd:function(a){a=void 0===a?Log.log:a;for(var b=0,c=0,e=Log.time,g=0,d=a.length;g<d;g++){var f=a[g];
"undefined"!=f.e&&(b+=Number(e.duration(e.parse(f.s),e.parse(f.e))),c++)}return b/c},lh:function(a){a=void 0===a?Log.log:a;if(0==a.length)return 0;for(var b=0,c=Log.time,e=0,g=a.length;e<g;e++)if("undefined"!=a[e].e){var d=a[e];d=Number(c.duration(c.parse(d.s),c.parse(d.e)));b+=d}return b},lp:function(a){a=void 0===a?Log.log:a;if(0==a.length)return 0;var b=Log.time,c=b.convert(b.parse(a[0].s));b=b.convert(b.parse(a[a.length-1].s));a=Number(Log.data.lh(a));c=Math.ceil((new Date(b.getFullYear(),b.getMonth(),
b.getDate())-new Date(c.getFullYear(),c.getMonth(),c.getDate()))/864E5);return a/(24*(c+1))*100},sh:function(a,b){for(var c=0,e=Log.time,g=0,d=a.length;g<d;g++){var f=a[g];"undefined"!=f.e&&f.c==b&&(c+=Number(e.duration(e.parse(f.s),e.parse(f.e))))}return c},sp:function(a,b){a=void 0===a?Log.log:a;return Log.data.sh(a,b)/Log.data.lh(a)*100},ph:function(a,b){for(var c=0,e=Log.time,g=0,d=a.length;g<d;g++){var f=a[g];"undefined"!=f.e&&f.t==b&&(c+=Number(e.duration(e.parse(f.s),e.parse(f.e))))}return c},
pp:function(a,b){a=void 0===a?Log.log:a;return Log.data.ph(a,b)/Log.data.lh(a)*100},trend:function(a,b){return(a-b)/b}},utils:{getMax:function(a){return a.reduce(function(a,c){return Math.max(a,c)})}},openSect:function(a){for(var b=document.getElementsByClassName("sect"),c=document.getElementsByClassName("tab"),e=0,g=b.length;e<g;e++)b[e].style.display="none";b=0;for(g=c.length;b<g;b++)c[b].className="pv1 tab on bg-noir blanc f6 mon tk mr3";document.getElementById(a).style.display="block";document.getElementById("b-"+
a).className="pv1 tab on bg-noir blanc f6 mon tk mr3 bb"},init:function(){Log.log=log;var a=Log.data,b=a.sp,c=new Date,e=new Date(c),g=function(a,b){document.getElementById(a).innerHTML=b.toFixed(2)},d=function(a,b){var c="",d,e=document.getElementById(a);0<b?(c="+"+b.toFixed(2),d="grn"):(c="-"+b.toFixed(2),d="red");e.innerHTML=c;e.className=d};e.setDate(c.getDate()-1);c=Log.data.getEntries(new Date);var f=Log.data.getEntries(e);Log.vis.bar(Log.log,"weekChart");Log.vis.peakH();Log.vis.peakD();Log.vis.day();
document.getElementById("status").className="rf mb4 f6 "+Log.status();var h=a.lh(),k=a.lh(c),n=a.lp(),l=a.lp(c),m=a.asd(),q=a.lsmin(c),p=a.lsmax(c),r=a.lsmin(),v=a.lsmax();e=a.trend(k,a.lh(f));var t=a.trend(l,a.lp(f)),u=a.trend(q,a.lsmin(f));f=a.trend(p,a.lsmax(f));a="LHH LHT LPH LPT ASD LSN LSX LSNH LSXH".split(" ");k=[h,k,n,l,m,q,p,r,v];h=["lhtt","lptt","lsnt","lsxt"];e=[e,t,u,f];u=0;for(t=a.length;u<t;u++)document.getElementById(a[u]).innerHTML=k[u].toFixed(2);a=0;for(t=h.length;a<t;a++)d(h[a],
e[a]);Log.vis.sectorBar(c,"sectorBar");Log.vis.projectBars(c,"projectStats");g("pCOD",b(Log.log,"COD"));g("pDSG",b(Log.log,"DSG"));g("pRES",b(Log.log,"RES"));g("pPHO",b(Log.log,"PHO"));g("pACA",b(Log.log,"ACA"));Log.vis.line(Log.log,"vis");Log.display(Log.log,"logbook")}};
